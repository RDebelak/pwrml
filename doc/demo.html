<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Demo</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Demo</h1>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pwrml)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mirt)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co"># To install the most recent mirt version (currently, some matrices may otherwise not be calculated correctly):</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co"># library(devtools)</span></span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="co"># install_github(&#39;philchalmers/mirt&#39;)</span></span></code></pre></div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>This vignette introduces the implementation of a power analysis for the Wald, LR, score and gradient test for linear hypothesis. It uses some IRT examples and treats basic as well as additional features of the package. It is directed towards beginner to intermediate level R users. Previous experience with the mirt package may be helpful. In the following we will cover the three-step workflow in detail:</p>
<ul>
<li>Setup Hypotheses (setup_hypothesis)</li>
<li>Calculate Noncentrality Parameters (calculate_ncps)</li>
<li>Calculate Power or Sample Size (power, ssize)</li>
</ul>
<p>As additional features, we cover:</p>
<ul>
<li>Generate artificial datasets</li>
<li>Performing hypothesis tests</li>
<li>Estimating the time needed</li>
</ul>
</div>
<div id="workflow-example" class="section level1">
<h1>Workflow example</h1>
<p>We want to know the power and required sample size for a test of the Rasch vs 2PL model. We use the LSAT 7 Dataset from the mirt package.</p>
<p>As a first step, we load the dataset and fit a 2PL model.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span> <span class="fu">expand.table</span>(LSAT7)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>mirtfit <span class="ot">&lt;-</span> <span class="fu">mirt</span>(dat,<span class="dv">1</span>,<span class="at">verbose =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<p>The 2PL parameters are then used as parameters for the alternative hypothesis in our hypothesis definition.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>hyp <span class="ot">&lt;-</span> <span class="fu">setup_hypothesis</span>(<span class="at">type =</span> <span class="st">&quot;1PLvs2PL&quot;</span>, <span class="at">altpars =</span> mirtfit)</span></code></pre></div>
<p>We can now calculate the noncentrality parameters.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>ncps <span class="ot">&lt;-</span> <span class="fu">calculate_ncps</span>(<span class="at">hyp=</span>hyp)</span></code></pre></div>
<p>From the noncentrality parameters, we can estimate the power or required sample size.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">power</span>(<span class="at">hyp=</span>hyp,<span class="at">ncp=</span>ncps,<span class="at">alpha=</span>.<span class="dv">05</span>,<span class="at">ssize=</span><span class="dv">500</span>)</span></code></pre></div>
<pre><code>##      Wald        LR     Score  Gradient 
## 0.4159277 0.5218344 0.4989753 0.5841164</code></pre>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ssize</span>(<span class="at">hyp=</span>hyp,<span class="at">ncp=</span>ncps,<span class="at">alpha=</span>.<span class="dv">05</span>,<span class="at">power=</span>.<span class="dv">80</span>)</span></code></pre></div>
<pre><code>##     Wald       LR    Score Gradient 
##     1134      887      932      778</code></pre>
</div>
<div id="functions-in-detail" class="section level1">
<h1>Functions in detail</h1>
<p>We will present all included functions and their arguments in more detail.</p>
<div id="setup-hypotheses-setup_hypothesis" class="section level2">
<h2>Setup Hypotheses (setup_hypothesis)</h2>
<p>We can either use a fitted mirt model or specify alternative parameters directly. An example of the letter would be:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>altpars <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">a =</span> <span class="fu">rlnorm</span>(<span class="dv">5</span>,<span class="at">sdlog =</span> .<span class="dv">4</span>),</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">d =</span> <span class="fu">rnorm</span>(<span class="dv">5</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>altpars</span></code></pre></div>
<pre><code>## $a
## [1] 0.9199460 1.3969893 0.9322849 0.5221568 1.0572218
## 
## $d
## [1] -0.1699429 -0.1314641  0.3601523 -0.2468364  0.2585742</code></pre>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>hyp <span class="ot">&lt;-</span> <span class="fu">setup_hypothesis</span>(<span class="at">type =</span> <span class="st">&quot;1PLvs2PL&quot;</span>, <span class="at">altpars =</span> altpars)</span></code></pre></div>
<p>The following alternative hypotheses are currently implemented.</p>
<ul>
<li>Rasch against 2PL</li>
<li>DIF in 2PL</li>
</ul>
<p>The Rasch against 2PL hypothesis is presented above. The procedure for the DIF in 2PL hypothesis is analogous, yet is a bit more complicated since we need to define different groups:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>group1 <span class="ot">=</span> group2 <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">a =</span> <span class="fu">rlnorm</span>(<span class="dv">5</span>,<span class="at">sdlog =</span> .<span class="dv">2</span>),</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">d =</span> <span class="fu">rnorm</span>(<span class="dv">5</span>)</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>group2<span class="sc">$</span>a[<span class="dv">1</span>] <span class="ot">=</span> (group2<span class="sc">$</span>a[<span class="dv">1</span>])<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>group2<span class="sc">$</span>d[<span class="dv">1</span>] <span class="ot">=</span> group2<span class="sc">$</span>d[<span class="dv">1</span>] <span class="sc">+</span> .<span class="dv">5</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>altpars <span class="ot">&lt;-</span> <span class="fu">list</span>(group1,group2)</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>altpars</span></code></pre></div>
<pre><code>## [[1]]
## [[1]]$a
## [1] 0.9214868 1.0568181 1.1942640 1.1283070 0.8551441
## 
## [[1]]$d
## [1] -0.5393501 -0.5184747  1.5167550 -0.1769903  0.8811290
## 
## 
## [[2]]
## [[2]]$a
## [1] 0.8491380 1.0568181 1.1942640 1.1283070 0.8551441
## 
## [[2]]$d
## [1] -0.03935006 -0.51847472  1.51675504 -0.17699033  0.88112899</code></pre>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>hyp <span class="ot">&lt;-</span> <span class="fu">setup_hypothesis</span>(<span class="at">type =</span> <span class="st">&quot;DIF2PL&quot;</span>, <span class="at">altpars =</span> altpars)</span></code></pre></div>
<p>To implement custom hypotheses, please refer to the respective vignette. Note that for both hypothesis types, we do not have to provide the parameters under the null hypothesis here, because they are implicitly defined by the hypotheses. The setup_hypothesis function, however, also takes a nullpars argument for cases in which the parmaters under the null hypothesis are not identified by the parameters under the alternative.</p>
</div>
<div id="calculate-noncentrality-parameters-calculate_ncps" class="section level2">
<h2>Calculate Noncentrality Parameters (calculate_ncps)</h2>
<p>The calculation of noncentrality parameters is straightforward.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>ncps <span class="ot">&lt;-</span> <span class="fu">calculate_ncps</span>(<span class="at">hyp=</span>hyp)</span></code></pre></div>
<p>To use the sampling-based parameters, one may use sampling=TRUE. The sample size of the sampling-based approach and the approximation of the Fisher expected matrix may be tweaked or left at their default values.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>ncps <span class="ot">&lt;-</span> <span class="fu">calculate_ncps</span>(<span class="at">hyp=</span>hyp,<span class="at">sampling=</span><span class="cn">TRUE</span>,<span class="at">sampling.npers =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>,<span class="at">approx.npers=</span><span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)</span></code></pre></div>
</div>
<div id="calculate-power-or-sample-size-power-ssize" class="section level2">
<h2>Calculate Power or Sample Size (power, ssize)</h2>
<p>The functions to calculate power and sample size are straightforward. One may use them to plot a power curve.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">100</span>,<span class="dv">2000</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>pow <span class="ot">=</span> <span class="fu">power</span>(<span class="at">hyp=</span>hyp,<span class="at">ncp=</span>ncps[<span class="st">&quot;Gradient&quot;</span>],<span class="at">alpha=</span>.<span class="dv">05</span>,<span class="at">ssize=</span>n)</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(n,pow)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="additional-features" class="section level1">
<h1>Additional Features</h1>
<p>We will take a look at some additional features.</p>
<div id="generate-artificial-datasets" class="section level2">
<h2>Generate artificial datasets</h2>
<p>The hypothesis object can also be used to generate data according to the parameters of the alternative hypothesis. Note that setup.data also allows for non-normal person distributions, e.g. uniform or skewed-normal distributions.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>altpars <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">a =</span> <span class="fu">rlnorm</span>(<span class="dv">5</span>,<span class="at">sdlog =</span> .<span class="dv">4</span>),</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">d =</span> <span class="fu">rnorm</span>(<span class="dv">5</span>)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>hyp <span class="ot">&lt;-</span> <span class="fu">setup_hypothesis</span>(<span class="at">type =</span> <span class="st">&quot;1PLvs2PL&quot;</span>, <span class="at">altpars =</span> altpars)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">setup.data</span>(<span class="at">hyp=</span>hyp,<span class="at">n=</span><span class="dv">500</span>)</span></code></pre></div>
</div>
<div id="performing-hypothesis-tests" class="section level2">
<h2>Performing Hypothesis Tests</h2>
<p>One can also perform hypothesis tests on observed data. This is done in two steps, model fitting (mml.fit) and calculation of the statitics (stat_obs). To fit both an unrestricted and restricted model in one go, we specify the data and the hypothesis.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fitted <span class="ot">&lt;-</span> <span class="fu">mml.fit</span>(<span class="at">data =</span> data,<span class="at">hyp =</span> hyp)</span></code></pre></div>
<p>One may also use an approximation of the Fisher expected matrix, e.g. for larger item sets.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>fitted <span class="ot">&lt;-</span> <span class="fu">mml.fit</span>(<span class="at">data =</span> data,<span class="at">hyp =</span> hyp,<span class="at">infmat.unres =</span> <span class="st">&quot;ApproxFisher&quot;</span>,<span class="at">infmat.res=</span><span class="st">&quot;ApproxFisher&quot;</span>,<span class="at">approx.npers =</span> <span class="dv">10</span><span class="sc">^</span><span class="dv">4</span>)</span></code></pre></div>
<p>From the results, we can calculate the observed statistics and p-values.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>stats_obs <span class="ot">&lt;-</span> <span class="fu">stat_obs</span>(fitted)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>stats_obs</span></code></pre></div>
<pre><code>##      Wald        LR     Score  Gradient 
## 12.605441 10.620425 10.181045  9.931108</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>pvals <span class="ot">&lt;-</span> <span class="fu">pchisq</span>(stats_obs,<span class="at">df=</span><span class="fu">nrow</span>(hyp<span class="sc">$</span>resmod<span class="sc">$</span>Amat),<span class="at">ncp=</span><span class="dv">0</span>,<span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>pvals</span></code></pre></div>
<pre><code>##       Wald         LR      Score   Gradient 
## 0.01337359 0.03117798 0.03748597 0.04160428</code></pre>
</div>
<div id="estimating-the-time-needed-for-the-analytical-approach" class="section level2">
<h2>Estimating the time needed for the analytical approach</h2>
<p>We can calculate the approximate time needed to calculate the analytical noncentrality parameters using a larger numbers of items.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>altpars <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">a =</span> <span class="fu">rlnorm</span>(<span class="dv">5</span>,<span class="at">sdlog =</span> .<span class="dv">4</span>),</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">d =</span> <span class="fu">rnorm</span>(<span class="dv">5</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>hyp <span class="ot">&lt;-</span> <span class="fu">setup_hypothesis</span>(<span class="at">type =</span> <span class="st">&quot;1PLvs2PL&quot;</span>, <span class="at">altpars =</span> altpars)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="fu">calctime</span>(hyp,<span class="at">n.items=</span><span class="dv">7</span>)</span></code></pre></div>
<pre><code>## [1] 13.48</code></pre>
<p>Measuring the actual time for comparison:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>altpars <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">a =</span> <span class="fu">rlnorm</span>(<span class="dv">7</span>,<span class="at">sdlog =</span> .<span class="dv">4</span>),</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">d =</span> <span class="fu">rnorm</span>(<span class="dv">7</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>hyp <span class="ot">&lt;-</span> <span class="fu">setup_hypothesis</span>(<span class="at">type =</span> <span class="st">&quot;1PLvs2PL&quot;</span>, <span class="at">altpars =</span> altpars)</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a><span class="fu">calctime</span>(hyp,<span class="at">n.items=</span><span class="dv">7</span>)</span></code></pre></div>
<pre><code>## [1] 36.37</code></pre>
<p>The time measuring method is currently not very accurate. As a result from my test runs, I suggest to expect +80% as a worst case scenario.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
